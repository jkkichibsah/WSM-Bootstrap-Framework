function RqlConnector(e,n){this.LoginGuid=e,this.SessionKey=n,this.DCOM="DCOM",this.DCOMProxyUrl="rqlconnector/rqlaction.asp",this.WebService11="WebService11",this.WebService11ProxyUrl="rqlconnector/rqlactionwebservice.aspx",this.WebService11Url="/CMS/WebService/RqlWebService.svc",this.RqlConnectionType=""}RqlConnector.prototype.SetConnectionType=function(e){this.RqlConnectionType=e},RqlConnector.prototype.GetConnectionType=function(e){var n=this;""==this.RqlConnectionType?this.TestConnection(this.WebService11Url,function(t){t?n.SetConnectionType(n.WebService11):n.SetConnectionType(n.DCOM),e&&e(n.RqlConnectionType)}):e&&e(n.RqlConnectionType)},RqlConnector.prototype.SendRql=function(e,n,t){var o=this;this.GetConnectionType(function(i){switch(i){case o.DCOM:o.SendRqlCOM(e,n,t);break;case o.WebService11:o.SendRqlWebService(e,n,t)}})},RqlConnector.prototype.SendRqlWebService=function(e,n,t){var o="";o+='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">',o+='<s:Body><q1:Execute xmlns:q1="http://tempuri.org/RDCMSXMLServer/message/"><sParamA>',o+="<![CDATA["+this.PadRQLXML(e,n)+"]]>",o+="</sParamA><sErrorA></sErrorA><sResultInfoA></sResultInfoA></q1:Execute></s:Body>",o+="</s:Envelope>",$.post(this.WebService11ProxyUrl,{rqlxml:o,webserviceurl:this.WebService11Url},function(e){e=$.trim(e);var o=$($.parseXML(e)).find("Result").text();o=$.trim(o),e=n?o:$.parseXML(o),t(e)},"text")},RqlConnector.prototype.SendRqlCOM=function(e,n,t){var o=this.PadRQLXML(e,n);$.post(this.DCOMProxyUrl,{rqlxml:o},function(e){e=$.trim(e),n||(e=$.parseXML(e)),t(e)},"text")},RqlConnector.prototype.PadRQLXML=function(e,n){var t='<IODATA loginguid="'+this.LoginGuid+'" sessionkey="'+this.SessionKey+'">';return n&&(t='<IODATA loginguid="'+this.LoginGuid+'" sessionkey="'+this.SessionKey+'" format="1">'),t+=e,t+="</IODATA>"},RqlConnector.prototype.TestConnection=function(e,n){$.ajax({async:!0,url:e,success:function(){n&&n(!0)},error:function(){n&&n(!1)}})};